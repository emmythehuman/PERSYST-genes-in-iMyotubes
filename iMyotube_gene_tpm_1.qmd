---
title: "iMyotube Gene Expression"
author:   
  - "Emmylou Cortez Nicolas-Martinez"
  - "RNA-seq analysis pipeline: Dr. Lachlan Warren William Baer"
date-modified: "2025-11-27"
format: 
  html:
    title-block: true
    embed-resources: true
    self-contained: true
    output-file: index.html
    keep-md: true
editor: visual
execute:
  freeze: false
---

```{r setup, include=FALSE}
library(readxl)
library(readr)
library(dplyr)
library(reactable)

# Automatically set working directory (works inside or outside RStudio)
this_dir <- dirname(knitr::current_input())
setwd(this_dir)

knitr::opts_chunk$set(echo = TRUE)
```
Data show averaged TPM values across different days of human dermal skin fibroblasts transdifferentiated to iMyotubes using four biological replicates (MC2936, MC3652, FC45. FC46).

## **Gene Level Expression in iMyotubes**
```{r dge}
#| echo: false
#| message: false
#| warning: false

# Load required libraries
library(reactable)
library(dplyr)
library(readxl)
library(readr)

# Load the gene expression data
# Update this path to match your file location
dge1 <- read_excel("dge_TPM_with_names_1_average_with_names.xlsx")

# Create the interactive table
reactable(
  compact = TRUE,
  width = "100%",
  dge1,
  searchable = TRUE,
  sortable = TRUE,
  pagination = TRUE,
  defaultPageSize = 10,
  showPageSizeOptions = TRUE,
  pageSizeOptions = c(10, 25, 50, 100),
  highlight = TRUE,
  striped = TRUE,
  defaultSorted = "gene_name",
  columns = list(
      gene_name = colDef(
      name = "Gene Name",
      headerStyle = list(textAlign = "center"),
      minWidth = 120,
      sortable = TRUE,
      style = list(fontWeight = "600", color = "#2c3e50")
    ),
    `Day 0` = colDef(
      name = "Fibroblast\nDay 0",
      format = colFormat(digits = 1),
      headerStyle = list(textAlign = "center"),
      minWidth = 100,
      sortable = TRUE,
      style = function(value) {
        if (is.numeric(value)) {
          if (value < 10) {
            list(background = "transparent")
          } else if (value < 100) {
            list(background = "#fde0dc", color = "black") # light red
          } else if (value < 1000) {
            list(background = "#f9bdbb", color = "black")
          } else if (value < 10000) {
            list(background = "#ee7272", color = "black")
          } else if (value < 100000) {
            list(background = "#ea4444", color = "black")
          }
        }
      }
    ),
    `Day 5` = colDef(
      name = "iMyotubes\nDay 5",
      format = colFormat(digits = 1),
      headerStyle = list(textAlign = "center"),
      minWidth = 100,
      sortable = TRUE,
      style = function(value) {
        if (is.numeric(value)) {
          if (value < 10) {
            list(background = "transparent")
          } else if (value < 100) {
            list(background = "#fde0dc", color = "black")
          } else if (value < 1000) {
            list(background = "#f9bdbb", color = "black")
          } else if (value < 10000) {
            list(background = "#ee7272", color = "black")
          } else if (value < 100000) {
            list(background = "#ea4444", color = "black")
          }
        }
      }
    ),
    `Day 9` = colDef(
      name = "iMyotubes\nDay 9",
      format = colFormat(digits = 1),
      headerStyle = list(textAlign = "center"),
      minWidth = 100,
      sortable = TRUE,
      style = function(value) {
        if (is.numeric(value)) {
          if (value < 10) {
            list(background = "transparent")
          } else if (value < 100) {
            list(background = "#fde0dc", color = "black")
          } else if (value < 1000) {
            list(background = "#f9bdbb", color = "black")
          } else if (value < 10000) {
            list(background = "#ee7272", color = "black")
          } else if (value < 100000) {
            list(background = "#ea4444", color = "black")
          }
        }
      }
    ),
    `Day 12` = colDef(
      name = "iMyotubes\nDay 12",
      format = colFormat(digits = 1),
      headerStyle = list(textAlign = "center"),
      minWidth = 100,
      sortable = TRUE,
      style = function(value) {
        if (is.numeric(value)) {
          if (value < 10) {
            list(background = "transparent")
          } else if (value < 100) {
            list(background = "#fde0dc", color = "black")
          } else if (value < 1000) {
            list(background = "#f9bdbb", color = "black")
          } else if (value < 10000) {
            list(background = "#ee7272", color = "black")
          } else if (value < 100000) {
            list(background = "#ea4444", color = "black")
          }
        }
      }
    ),
    `Day 15` = colDef(
      name = "iMyotubes\nDay 15",
      format = colFormat(digits = 1),
      headerStyle = list(textAlign = "center"),
      minWidth = 100,
      sortable = TRUE,
      style = function(value) {
        if (is.numeric(value)) {
          if (value < 10) {
            list(background = "transparent")
          } else if (value < 100) {
            list(background = "#fde0dc", color = "black")
          } else if (value < 1000) {
            list(background = "#f9bdbb", color = "black")
          } else if (value < 10000) {
            list(background = "#ee7272", color = "black")
          } else if (value < 100000) {
            list(background = "#ea4444", color = "black")
          }
        }
      }
    )
  ),
  paginationType = "jump",   # <<–– adds "jump to page" input beside pagination
  theme = reactableTheme(
    searchInputStyle = list(
      width = "300px",
      height = "40px",
      fontSize = "16px",
      padding = "8px 12px",
      border = "2px solid #dee2e6",
      borderRadius = "4px",
      marginBottom = "20px"
    ),
    headerStyle = list(
      background = "#f8f9fa",
      color = "#495057",
      fontWeight = "600",
      borderBottom = "2px solid #dee2e6"
    )
  )
)
```

#### Data Description

-   **Time points**: Days 0, 5, 9, 12, and 15 of iMyotube transdifferentiation
-   **Values**: Average TPM across 4 biological replicates (MC2936, MC3652, FC45, FC46)
-   Genes with 0TPM across all timepoints are removed.
